#+TITLE: Bind实现DNS高可用性
#+AUTHOR: wanglifeng
#+OPTIONS: H:4 ^:nil
#+LATEX_CLASS: latex-doc
#+PAGE_TAGS: bind
#+PAGE_CATETORIES: network
#+PAGE_LAYOUT: post

#+HTML: <!--abstract-begin-->
Bind是最常使用的DNS服务器软件，互联网中约90%的名称解析服务由Bind完成。本文主要讲述如何通过配置Master-Slave服务，实现高可用性。
#+HTML: <!--abstract-end-->

* 主从设置

** Primary服务器设置

#+BEGIN_EXAMPLE
zone "movie.edu" IN {
        type master;
        file "named.movie.edu";
};

zone "249.249.192.in-addr.arpa" IN {
        type master;
        file "named.192.249.249";
};
#+END_EXAMPLE

** Slave服务器设置

#+BEGIN_EXAMPLE
zone "movie.edu" IN {
        type slave;
        file "bak.movie.edu";
        masters {172.16.10.51; };
};

zone "249.249.192.in-addr.arpa" IN {
        type slave;
        file "bak.192.249.249";
        masters {172.16.10.51; };
};
#+END_EXAMPLE

* 关于更新时间

更新时间与SOA中的几个参数有关:

#+BEGIN_EXAMPLE
movie.edu. IN SOA toystory.movie.edu. al.movie.edu. (
        201405211021 ; Serial
        3H ; Refresh after 3 hours
        1H ; Retry after 1 hour
        1W ; Expire after 1 week
        1H )
#+END_EXAMPLE

Slave服务器根据序号高低来判断，自身是否需要从主服务器更新数据。

* 常见错误

#+BEGIN_EXAMPLE
May 21 22:03:24 realsrv02 named[26175]: dumping master file: tmp-KxnfE34nIM: open: permission denied
#+END_EXAMPLE

解决方法:

#+BEGIN_EXAMPLE
chmod g+w /var/named
#+END_EXAMPLE

* 参考资料

[[http://shop.oreilly.com/product/9780596100575.do][DNS and BIND, 5th Edition By Cricket Liu, Paul Albitz.]]
